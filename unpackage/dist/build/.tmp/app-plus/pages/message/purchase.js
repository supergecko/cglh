(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/message/purchase"],{1255:function(t,e,a){"use strict";a.r(e);var s=a("4f2c"),i=a.n(s);for(var n in s)"default"!==n&&function(t){a.d(e,t,function(){return s[t]})}(n);e["default"]=i.a},"1d21":function(t,e,a){},"4f2c":function(t,e,a){"use strict";(function(t,s){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(){return Promise.all([a.e("common/vendor"),a.e("components/chunLei-modal/chunLei-modal")]).then(a.bind(null,"0b2c"))},n={components:{chunLeiModal:i},data:function(){return{value:!1,inputData:{title:"输入资金密码",content:[{title:"密码",content:"",type:"password",placeholder:"请输入资金密码"}]},presaleInfo:{},number:"",activity_product_id:0,activity_id:0,chooseCla:!0,hour:0}},onLoad:function(t){this.activity_product_id=t.activity_product_id,this.activity_id=t.activity_id,this._presale(t.activity_product_id,t.activity_id)},methods:{switch1Change:function(t){!0===t.target.value?parseFloat(this.presaleInfo.assets)>this.presaleInfo.rest?this.number=this.presaleInfo.rest:this.number=this.presaleInfo.assets:this.number=""},onConfirm:function(e){""===e[0].content?console.log(t("为空"+e[0].content," at pages\\message\\purchase.vue:97")):(console.log(t("不为空"+e[0].content," at pages\\message\\purchase.vue:99")),this._securityPasswordAuthAgain(e[0].content))},cancel:function(){},toggleChooseCla:function(){this.chooseCla=!this.chooseCla},_securityPasswordAuthAgain:function(t){var e=this,a=s.getStorageSync("user_mobile"),i=t,n=Date.parse(new Date)/1e3,o=this.$md5("".concat(a,"**").concat(i,"**").concat(n,"**cglhhaofengshui")),c={password:i,timestamp:n,sign:o};this.$ajax.post({url:this.$service.api_lists.securityPasswordAuthAgain,data:c}).then(function(t){1==t.data.code&&e._buyPresale(),s.hideLoading()}).catch(function(t){s.hideLoading(),s.showToast({title:t,duration:2e3})})},_checkSecurityPasswordAuth:function(){var e=this,a=0;if(""!==this.number)if(!1!==this.chooseCla){if(a=parseFloat(this.presaleInfo.assets)>this.presaleInfo.rest?this.presaleInfo.rest:this.presaleInfo.assets,a<this.presaleInfo.rest){if(this.number>a)return s.showToast({icon:"none",title:"可用数量不足"}),void(this.number=this.presaleInfo.assets)}else if(this.number>a)return s.showToast({icon:"none",title:"最高认购".concat(this.presaleInfo.rest)}),void(this.number=this.presaleInfo.rest);s.getNetworkType({success:function(t){"none"==t.networkType&&s.showToast({icon:"none",title:"当前网络不可用"})}}),s.showLoading({title:"加载中"});var i=s.getStorageSync("user_mobile"),n=Date.parse(new Date)/1e3,o=this.$md5("".concat(i,"**").concat(n,"**cglhhaofengshui")),c={timestamp:n,sign:o};this.$ajax.post({url:this.$service.api_lists.checkSecurityPasswordAuth,data:c}).then(function(a){if(1==a.data.code)switch(e.hour=a.data.data.hour,console.log(t(a.data.data.status," at pages\\message\\purchase.vue:202")),a.data.data.status){case 1:s.showToast({icon:"none",title:a.data.msg});break;case 2:s.showToast({icon:"none",title:a.data.msg});break;case 3:e.value=!e.value;break;default:e._buyPresale()}s.hideLoading()}).catch(function(t){s.hideLoading(),s.showToast({title:t,duration:2e3})})}else s.showToast({icon:"none",title:"请勾选服务协议"});else s.showToast({icon:"none",title:"请输入认购数量"})},_presale:function(t,e){var a=this;s.getNetworkType({success:function(t){"none"==t.networkType&&s.showToast({icon:"none",title:"当前网络不可用"})}}),s.showLoading({title:"加载中"});var i=s.getStorageSync("user_mobile"),n=t,o=e,c=Date.parse(new Date)/1e3,r=this.$md5("".concat(i,"**").concat(o,"**").concat(n,"**").concat(c,"**cglhhaofengshui")),u={activity_product_id:n,activity_id:o,timestamp:c,sign:r};this.$ajax.post({url:this.$service.api_lists.presale,data:u}).then(function(t){1==t.data.code&&(a.presaleInfo=t.data.data),s.hideLoading()}).catch(function(t){s.hideLoading(),s.showToast({title:t,duration:2e3})})},_buyPresale:function(){var e=this;s.getNetworkType({success:function(t){"none"==t.networkType&&s.showToast({icon:"none",title:"当前网络不可用"})}}),s.showLoading({title:"加载中"});var a=s.getStorageSync("user_mobile"),i=this.activity_product_id,n=this.activity_id,o=this.number,c=Date.parse(new Date)/1e3,r=this.$md5("".concat(a,"**").concat(n,"**").concat(i,"**").concat(o,"**").concat(c,"**cglhhaofengshui")),u={activity_product_id:i,activity_id:n,amount:o,timestamp:c,sign:r};this.$ajax.post({url:this.$service.api_lists.buyPresale,data:u}).then(function(a){if(1==a.data.code){console.log(t(a.data.msg," at pages\\message\\purchase.vue:313")),s.showToast({icon:"none",title:a.data.msg});var i=e;setTimeout(function(){i._presale(i.activity_product_id,i.activity_id)},1e3)}s.hideLoading()}).catch(function(t){s.hideLoading(),s.showToast({title:t,duration:2e3})})}}};e.default=n}).call(this,a("0de9")["default"],a("6e42")["default"])},5831:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement;t._self._c},i=[];a.d(e,"a",function(){return s}),a.d(e,"b",function(){return i})},a55b:function(t,e,a){"use strict";a.r(e);var s=a("5831"),i=a("1255");for(var n in i)"default"!==n&&function(t){a.d(e,t,function(){return i[t]})}(n);a("b129");var o=a("2877"),c=Object(o["a"])(i["default"],s["a"],s["b"],!1,null,"01437e88",null);e["default"]=c.exports},b129:function(t,e,a){"use strict";var s=a("1d21"),i=a.n(s);i.a},b5a6:function(t,e,a){"use strict";(function(t){a("590a"),a("921b");s(a("66fd"));var e=s(a("a55b"));function s(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,a("6e42")["createPage"])}},[["b5a6","common/runtime","common/vendor"]]]);